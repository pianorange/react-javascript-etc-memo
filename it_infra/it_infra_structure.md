## Chapter 1 인프라 아키택쳐를 살펴보자

인프라 = IT기반이 되는 것.  
아키텍쳐 = 구조

모든곳에서 공통으로 사용가능한 아키텍쳐가 있을까?  
No.  
아키텍쳐나 설계 요소에는 반드시 장점과 단점 공존.  
가장 큰 제약 : 시스템 도입 비용  
ex) 100만명 사용하는 시스템과 10명 사용하는 시스템 예산 차이 큼

### 1.2 집약형과 분할형 아키텍쳐

IT 인프라는 컴퓨터로 구성되며, 집약형과 분할형 존재.

#### 1.2.1 집약형 아키텍쳐

옛날 에는 대형 컴퓨터 이용 모든 업무 처리하는 범용장비가 사용됨  
모든 처리를 한대로 하기 때문에 장비 고장 등으로 업무 멈추지 않도록 고민이 필요.  
복수의 서로 다른 업무 처리 동시 실행 하도록 유한 리소스 관리 필요.  
한대의 컴퓨터지만 안에 여러 프로세스가 존재, 하드웨어 일부 고장에도 작동 필요.

(기간 시스템, 호스트, 메인프레임 등으로도 불림)  
장점: 한대의 대형 컴퓨터. 구성이 간단하다, 리소스관리, 이중화에 의해 안정성 높고 고성능.
단점: 도입비용, 유지비용 크다. 확장성에 한계가 있다.

#### 1.2.2 분할형 아키텍쳐

여러 대의 컴퓨터를 조합해서 하나의 시스템을 구축하는 구조.  
-> 대형 컴퓨터가 했던 처리 다수 소형 컴퓨터 분할 처리.  
서버 분할 일반적인 방식은 수직형과 수평형 2가지 존재.  
수직형: 각 서버별로 다른 역할 담당  
수평형: 각 서버가 같은 역할 담당

장점:

1. 대형컴퓨터는 매우 고가. 저가 장비 이용 전체적인 비용 절감 가능
2. 안정성은 대형 컴퓨터에 못미치지만, 여러 대의 컴퓨터 이용 한 대가 고장 나도 안정성 담보 가능
3. 서버 대수 늘릴 수 있어서 확장성 높다.

단점:

1. 대수가 늘어나면 관리 구조 복잡해짐
2. 한 대가 망가지면 영향 범위 최소화 위한 구조를 검토해야 함

#### 물리 서버와 논리 서버의 차이

분할형 아키텍쳐 이용되는 컴퓨터를 서버라고 함.  
-> 서버는 컴퓨터 자체(하드웨어, 물리적인 의미)를 칭하기도 하고 컴퓨터에서 동작하는 소프트웨어(DB서버, 웹 서버, 논리적 의미)를 칭하기도 함.  
서버의 본래 의미: 특정 역할에 특화된 것

### 1.3 수직 분할형 아키텍쳐

서버별로 다른 역할 담당  
특정 서버 측면에서 봣을 때 역할에 따라 '위'또는 '아래'계층으로 나뉨

#### 1.3.1 클라이언트-서버형 아키텍쳐

클라이언트-서버형은 수직분할형의 한 예이다.  
물리서버는 애플리케이션, 미들웨어, 데이터베이스 등 소프트웨어를 물리서버 상에서 운영  
클라이언트(또는 단말)은 서버에 접속해서 서비스 이용하는 형태

클라이언트-서버형의 특징

- 클라이언트 측에 전용 소프트웨어 설치 (ex 주식 판매 프로그램)
  ->그래프표시나 주가 흐름 분석은 PC에서 하고 주가 데이터 취득은 서버에서  
  ->처리는 각각의 클라이언트 단말에 맡기고 서버는 데이터 입출력만 하면 되기 때문에 처리당 부하량을 낮출 수 있다.  
  -> 부하가 낮은 만큼 소수의 서버로 다수의 클라이언트 처리 가능

클라이언트-서버형의 단점  
업무 애플리케이션 갱신 시마다 클라이언트 측 소프트웨어도 업데이트 해야한다.  
이용자 측에서 불편, 무시하고 넘어가는 경우도 많아 시스템 위험 요소가 될 수 있다.

- 클라이언트 측의 소프트 웨어 정기 업데이트 필요
- 서버 확장성에 한계 발생 가능성

#### 1.3.2 3계층형 아키텍쳐

클라이언트-서버의 발전된 형태  
-> 클라이언트와 서버만 나뉘어 있었기 때문에 서버에 너무 많은 부하가 집중됨  
-> 이에 서버의 역할을 나눠 부하 집중문제를 해결함  
-> 웹 브라우저를 통한 접속(프레젠테이션 계층 있으므로)이므로 클라이언트 업데이트 필요 X

<3계층의 구성>

1. 프레젠테이션 계층

- 사용자 입력을 받음
- 웹 프라우저 화면 표시

2. 애플리케이션 계층

- 사용자 요청에 따라 업무처리

3. 데이터 계층

- 애플리케이션 계층의 요청에 따라 데이터 입출력

웹브라우저 통해 시스탬에 접속(사용자)  
->사용자가 웹 브라우저에 입력하는 화면은 프레젠테이션 계층의 웹 서버에 먼저 전달 됨  
-> 웹 서버는 그 요청을 애플리케이션 계층의 AP(application)서버에 전달  
-> AP서버는 데이텨 계층의 데이터 베이스에 데이터 요청

장점

- 서버 부하 집중 개선
- 클라이언트 단말의 정기 업데이트 불필요
- 처리반환에 의한 서버 부하 저감

단점

- 구조가 클라이언트-서버 구성보다 복잡하다.

##### Memo

웹소켓 : 기존 웹에서는 브라우저가 웹 서버에 요청을 보내서 그것을 받아 처리하는 구조  
-> 웹소캣은 요청이 없어도 웹 서버가 브라우저에 데이터를 전달(푸시)할 수 있다.  
이를 통해 브라우저가 더 많은 것을 실행할 수 있는 형태로 진화하고 있다.

### 1.4 수평 분할형 아키텍쳐

용도가 같은 서버를 늘려나가는 방식  
서버 대수 늘어나면 한 대가 시스템에 주는 영향력 낮아져 안정성 향상

- 수직 분할형과 수평 분할형은 배타적인 관계가 아니다 (대부분 두가지 방식 혼재)

#### 1.4.1 단순 수평 분할형 아키텍쳐

같은 기능 가진 복수의 시스템으로 단순 분할.  
sharding(샤딩), partitioning(파티셔닝)이라고도 부름 .
ex ) 3계층 레이어로 구성된 동일한 구성의 어플리케이션을 서울지사와 부산지사로 나눠 구성.  
-> 필요에 따라 서울지사에 접속해 데이터를 확인하거나 부산지사에 접속해 데이터 확인
거리상으로 멀리 떨어진 시스템에 자주 이용됨.  
 공장처럼 각 거점이 완전히 독립된 운영 하거나, 많은 사용자가 있는 SNS 웹 서비스에서 사용자 ID기준으로 서버를 분할(sharding)하기도 한다.

장점

1. 시스템 둘로 분할됨으로써 전체 처리성능 나눈만큼 향상(부하가 한곳으로 집중되지 않으니까)
2. 각각 독립된 시스템이므로 한쪽에 장애가 발생해도 상호 시스템간 영향 X

단점

1. 업데이트시마다 매번 양쪽시스템을 수정해야함
2. 데이터가 일원화 되어있지 않아 양쪽 데이터 동시 사용 불가
3. 처리량이 균등하게 분할돼 있지 않으면 서버별 처리량에 치우침 발생 가능성

#### 1.4.2 공유형 아키텍쳐

일반 기업 시스템이라면 완전 분리된 애플리케이션 이용하는 경우 드물다.  
공유형에서는 단순 분할형과 달리 일부 계층에서 상호 접속이 이루어짐.  
ex ) 단순 수평 분할형에서 DB데이터 동기화

장점

1. 수평으로 서버 늘리기 때문에 확장성향상
2. 분할한 시스템이 서로 다른 시스템의 데이터 참조가능

단점

- 분할한 시스템 간 독립성 낮아짐
- 공유한 계층의 확장성 낮아짐

##### Memo 가상화

집약형 : 대형 컴퓨터의 높은 비용이 문제, 확장성에 문제
분할형: 안정성문제, 구성이 복잡해짐

<b>가상화</b>: 집약형, 분할형 양쪽 장점을 취하는 접근법
ex) 물리서버 2대 준비, 가상화 기능으로 여러대 가상 서버로 분할.  
->물리서버 이중화 해서 한 대가 망가져도 계속해서 운영가능
-> 리소스의 확장성 보장 가능하며,가상서버 여러대로 처리량을 늘릴 수 있다.

## 1.5 지리 분할형 아키텍쳐

특정 목적에 맞춰 수직, 수평 분할 아키텍쳐 조합한 구성

### 1.5.1 스탠바이형 아키택쳐

스탠바이 구성, 액시브-스탠바이 구성, HA(High availability)구성 이라고도 부름.

물리 서버 최소 두대 준비 한대 고장나면 가동중인 소프트웨어를 다른 한대로 옮겨서 운영하는 방식  
이때 소프트웨어 재시작 자동으로 하는 구조 페일오버(failover)라고 함

단점

- 물리 서버 고장에 대처 가능하지만 보통 대는 페일오버 대상 서버(스탠바이)가 놀고 있는 상태가 되기 때문에 리소스 낭비 발생

->이 때문에 스탠바이 따로 두지 않고, 양쪽 서버 동시에 교차이용하다 한쪽이 고장나면 다른 한쪽으로 트래픽 집중시키는 방식 사용하는 경우도 많다.  
-> 가상화 서버 이용시 서버상의 소프트웨어 뿐만 아니라 다른 물리 서버에 페일오버 하는 방식도 선택지가 될 수 있음.
